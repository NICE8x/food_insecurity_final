---
title: "dashboard_2"
author: "Caroline Andy"
date: "11/27/2020"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    vertical_layout: fill
---

```{r setup, include=FALSE, message = FALSE, warning = FALSE, echo = FALSE}
library(tidyverse)
library(plotly)
library(flexdashboard)

knitr::opts_chunk$set(
	echo = TRUE,
	warning = FALSE,
	fig.width = 8, 
  fig.height = 6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

-----------------------------------------------------------------------

### Food Insecurity Rates in Select New York State Counties


```{r, message = FALSE, warning = FALSE, echo = FALSE}
read_csv("map_the_meal_gap_df.csv") %>%
  filter(county_state %in% c("saint lawrence_NY", "albany_NY", "chautauqua_NY", 
                             "new york_NY", "queens_NY", "kings_NY", "bronx_NY",
                             "westchester_NY")) %>%
  mutate(county = fct_reorder(county, desc(fi_rate))) %>%
  plot_ly(y = ~fi_rate, color = ~county, type = "box", colors = "viridis")
```

-----------------------------------------------------------------------

### Number of Food Insecure Individuals by New York State County

```{r, message = FALSE, warning = FALSE, echo = FALSE}
read_csv("map_the_meal_gap_df.csv") %>%
  filter(county_state %in% c("saint lawrence_NY", "albany_NY", "chautauqua_NY", 
                             "new york_NY", "queens_NY", "kings_NY", "bronx_NY",
                             "westchester_NY")) %>%
  mutate(county = fct_reorder(county, desc(number_food_insecure_individuals))) %>%
  plot_ly(y = ~number_food_insecure_individuals, color = ~county, type = "box", colors = "viridis")
```

-----------------------------------------------------------------------

### Child Food Insecurity Rates by Select New York State Counties

```{r, message = FALSE, warning = FALSE, echo = FALSE}
read_csv("map_the_meal_gap_df.csv") %>%
  filter(county_state %in% c("saint lawrence_NY", "albany_NY", "chautauqua_NY", 
                             "new york_NY", "queens_NY", "kings_NY", "bronx_NY",
                             "westchester_NY")) %>%
  mutate(county = fct_reorder(county, desc(child_fi_rate))) %>%
  plot_ly(y = ~child_fi_rate, color = ~county, type = "box", colors = "viridis")
```

-----------------------------------------------------------------------

### Number of Food Insecure Children by New York State County

```{r, message = FALSE, warning = FALSE, echo = FALSE}
read_csv("map_the_meal_gap_df.csv") %>%
  filter(county_state %in% c("saint lawrence_NY", "albany_NY", "chautauqua_NY", 
                             "new york_NY", "queens_NY", "kings_NY", "bronx_NY",
                             "westchester_NY")) %>%
  mutate(county = fct_reorder(county, desc(number_food_insecure_children))) %>%
  plot_ly(y = ~number_food_insecure_children, color = ~county, type = "box", colors = "viridis")
```

-----------------------------------------------------------------------

### Food Insecurity Rate by US Region

```{r, warning = FALSE, message = FALSE, echo = FALSE}
state = c("AL", "AK", "AZ", "AR", "CA", "CO", "CT", "DE", "FL", "GA", "HI", "ID", "IL",
          "IN", "IA", "KS", "KY", "LA", "ME", "MD", "MA", "MI", "MN", "MS", "MO", "MT",
          "NE", "NV", "NH", "NJ", "NM", "NY", "NC", "ND", "OH", "OK", "OR", "PA", "RI",
          "SC", "SD", "TN", "TX", "UT", "VT", "VA", "WA", "WV", "WI", "WY")
region = c("S", "W", "W", "S", "W", "W", "NE", "S", "S", "S", "W", "W", "MW", "MW", 
           "MW", "MW", "S", "S", "NE", "S", "NE", "MW", "MW", "S", "MW", "W", "MW", 
           "W", "NE", "NE", "W", "NE", "S", "MW", "MW", "S", "W", "NE", "NE", "S", 
           "MW", "S", "S", "W", "NE", "S", "W", "S", "MW", "W")

x_walk = tibble(state, region)
food = read_csv("map_the_meal_gap_df.csv") 

merge(food, x_walk, by = "state") %>%
  mutate(region = str_replace(region, "MW", "Midwest"),
         region = str_replace(region, "W", "West"),
         region = str_replace(region, "NE", "Northeast"),
         region = str_replace(region, "S", "South")) %>%
  group_by(region, year) %>%
  summarize(mean_fi = mean(fi_rate)) %>%
  ungroup() %>%
  mutate(region = fct_reorder(region, desc(mean_fi))) %>%
  plot_ly(y = ~mean_fi, color = ~region, type = "box", colors = "viridis")
```

-------------------------------------------------------------------------------

### Mean number of food insecure individuals by region

```{r, message = FALSE, warning = FALSE, echo = FALSE}
merge(food, x_walk, by = "state") %>%
  mutate(region = str_replace(region, "MW", "Midwest"),
         region = str_replace(region, "W", "West"),
         region = str_replace(region, "NE", "Northeast"),
         region = str_replace(region, "S", "South")) %>%
  group_by(region, year) %>%
  summarize(mean_num_fi_ind = mean(number_food_insecure_individuals)) %>%
  ungroup() %>%
  mutate(region = fct_reorder(region, desc(mean_num_fi_ind))) %>%
  plot_ly(y = ~mean_num_fi_ind, color = ~region, type = "box", colors = "viridis")
```

-------------------------------------------------------------------------------

### Mean child food insecurity rate by region

```{r, message = FALSE, warning = FALSE, echo = FALSE}
merge(food, x_walk, by = "state") %>%
  mutate(region = str_replace(region, "MW", "Midwest"),
         region = str_replace(region, "W", "West"),
         region = str_replace(region, "NE", "Northeast"),
         region = str_replace(region, "S", "South")) %>%
  group_by(region, year) %>%
  summarize(mean_child_fi_rate = mean(child_fi_rate)) %>%
  ungroup() %>%
  mutate(region = fct_reorder(region, desc(mean_child_fi_rate))) %>%
  plot_ly(y = ~mean_child_fi_rate, color = ~region, type = "box", colors = "viridis")
```

-------------------------------------------------------------------------------

### Mean number of food insecure children by region

```{r, message = FALSE, warning = FALSE, echo = FALSE}
merge(food, x_walk, by = "state") %>%
  mutate(region = str_replace(region, "MW", "Midwest"),
         region = str_replace(region, "W", "West"),
         region = str_replace(region, "NE", "Northeast"),
         region = str_replace(region, "S", "South")) %>%
  group_by(region, year) %>%
  summarize(mean_num_fi_kids = mean(number_food_insecure_children)) %>%
  ungroup() %>%
  mutate(region = fct_reorder(region, desc(mean_num_fi_kids))) %>%
  plot_ly(y = ~mean_num_fi_kids, color = ~region, type = "box", colors = "viridis")
```
